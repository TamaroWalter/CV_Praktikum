import matplotlib.pyplot as plt
import csv
import io

CSV_DATA = """epoch,train_loss,val_loss
1,2.165694737434387,2.1757458877563476
2,2.1105013823509218,2.1531570529937745
3,2.025182065963745,1.9816602373123169
4,1.9619541954994202,1.9703393602371215
5,1.922782790660858,1.9274703454971314
6,1.9155281162261963,1.9915368890762328
7,1.885436806678772,1.8932854890823365
8,1.8731863951683045,1.9025590991973877
9,1.8378831052780151,1.8784975624084472
10,1.8657640266418456,1.880296869277954
11,1.842055275440216,1.8872742128372193
12,1.8051117396354674,1.86633216381073
13,1.8075559091567994,1.8741285800933838
14,1.833777117729187,1.8761908435821533
15,1.8047510075569153,1.8608661222457885
16,1.782985589504242,1.8460434579849243
17,1.782738001346588,1.8414933490753174
18,1.7694431471824645,1.8286903429031371
19,1.7660864281654358,1.824300217628479
20,1.7492175316810608,1.8179279947280884
21,1.7355680108070373,1.81645761013031
22,1.734611382484436,1.84396071434021
23,1.7360644459724426,1.813776798248291
24,1.7185253620147705,1.8147916746139527
25,1.71079252243042,1.7893145895004272
26,1.704200701713562,1.8234419345855712
27,1.701133096218109,1.798506784439087
28,1.6889844584465026,1.7870712614059447
29,1.6814101839065552,1.799068946838379
30,1.682631413936615,1.7899927282333374
31,1.6763398766517639,1.7695150089263916
32,1.6736007523536682,1.7997033023834228
33,1.667905991077423,1.762582082748413
34,1.661207389831543,1.7633549690246582
35,1.6555216789245606,1.7633662223815918
36,1.6452780675888061,1.7635372304916381
37,1.6521980834007264,1.76562912940979
38,1.6476734924316405,1.754195761680603
39,1.6391961479187012,1.7569805812835693
40,1.6347871446609497,1.751867642402649
41,1.633279891014099,1.754497652053833
42,1.6339444303512574,1.7569521236419678
43,1.6246747803688049,1.75426589012146
44,1.6257793927192687,1.7485750818252563
45,1.6212336802482605,1.7542094802856445
46,1.618629548549652,1.752854857444763
47,1.618393325805664,1.753388843536377
48,1.6144051551818848,1.7535104990005492
49,1.6135659313201904,1.7531104755401612
50,1.6141804027557374,1.751668357849121
"""

reader = csv.DictReader(io.StringIO(CSV_DATA))
epochs, train_loss, val_loss = [], [], []
for row in reader:
    epochs.append(int(row["epoch"]))
    train_loss.append(float(row["train_loss"]))
    val_loss.append(float(row["val_loss"]))

fig, ax = plt.subplots(figsize=(9, 5))

ax.plot(epochs, train_loss, color="#4C72B0", linewidth=2, marker="o",
        markersize=4, label="Train Loss")
ax.plot(epochs, val_loss,   color="#DD8452", linewidth=2, marker="o",
        markersize=4, label="Validation Loss")

ax.set_xlabel("Epoche", fontsize=11)
ax.set_ylabel("Loss", fontsize=11)
ax.set_title("U-Net Trainingsverlauf", fontsize=13)
ax.legend(fontsize=10)
ax.yaxis.grid(True, linestyle="--", alpha=0.5)
ax.set_axisbelow(True)
ax.spines[["top", "right"]].set_visible(False)

plt.tight_layout()
plt.savefig("/home/tamaro/Downloads/a350loss.png", dpi=150, bbox_inches="tight")
print("Gespeichert.")